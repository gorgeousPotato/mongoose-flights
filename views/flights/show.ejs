<%- include('../partials/header') %>
<h2 class="margin-left first-h2"><%= title %></h2>
<section id="show-page">
  <div>Airlines:</div>
  <div><%= flight.airline %></div>
  <div>Airport:</div>
  <div><%= flight.airport %></div>
  <div>Flight Number:</div>
  <div><%= flight.flightNo %></div>
  <div>Departure:</div>
  <div><%= flight.departs %></div>
</section>
<br>
<h2 class="margin-left">Destinations</h2>
<form class="add-destination-form" method="POST" action="/flights/<%= flight._id %>/destinations">
  <label>Airport:</label>
  <select name="airport">
    <option>AUS</option>
    <option>DFW</option>
    <option>DEN</option>
    <option>LAX</option>
    <option>SAN</option>
  </select>
  <label>Arrival:</label>
  <input type="datetime-local" name="arrival"/> <br>
  <button type="submit">Save</button>
</form>
<% if (flight.destinations.length) {%>
  <table class="margin-left">
    <thead>
      <tr>
        <th>Airport</th>
        <th>Arrival</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td></td>
        <td>
          <form action="/flights/<%=flight._id%>" method="GET">
            <label for="sorted">Sort by Date</label>
            <input type="checkbox" name="sorted" <%=checked%> onChange="this.form.submit()"/>
          </form>
        </td>
      </tr>
      <% if (checked === "checked") { %>
        <% dest = flight.destinations %>
        <!-- <% dest = flight.destinations.sort((a,b) => a.arrival - b.arrival) %> -->
        <%} else {%>
          <% dest = flight.destinations %>
        <% } %>
      <% dest.forEach(d => { %>
        <tr>
          <td> <%= d.airport %></td>
          <td> <%= d.arrival %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>
<% } else { %>
  <h3 class="margin-left">No Destinations</h3>
<% } %>

<%- include('../partials/footer') %>
